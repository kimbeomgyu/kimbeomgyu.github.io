{"data":{"site":{"siteMetadata":{"author":{"name":"kim beom gyu","contacts":{"twitter":"#"}},"disqusShortname":"kimbeomgyu","subtitle":"반갑습니다. 신입 개발자 김범규입니다.","title":"Blog by kimbeomgyu","url":"https://kimbeomgyu.github.io"}},"markdownRemark":{"id":"0898db47-07e7-5e9f-bc79-9fd203d0c0b4","html":"<h4>사용자 목록 확인</h4>\n<p><code class=\"language-text\">use admin</code></p>\n<p><code class=\"language-text\">show users</code></p>\n<h4>모든 데이터베이스내의 사용자</h4>\n<p><code class=\"language-text\">use admin</code></p>\n<p><code class=\"language-text\">cur = db.system.users.find()</code></p>\n<p><code class=\"language-text\">cur.count()</code></p>\n<h4>계정생성</h4>\n<p><code class=\"language-text\">db.createUser</code> 해당 데이터베이스의 유저객체를 생성한다.</p>\n<ul>\n<li>관리자 계정 생성 예시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">use test\ndb<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">:</span> <span class=\"token string\">\"testUser\"</span><span class=\"token punctuation\">,</span>\n    pwd<span class=\"token punctuation\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span>\n    roles<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"readWrite\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dbAdmin\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>읽기권한, 특정 데이터베이스 읽고쓰기 권한 계정 생성 예시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">use admin\ndb<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">:</span> <span class=\"token string\">\"testUser\"</span><span class=\"token punctuation\">,</span>\n    userSource<span class=\"token punctuation\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span>\n    roles<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"read\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    otherDBRoles<span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span> testDB2<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"readWrite\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<h4>사용자 삭제</h4>\n<p><code class=\"language-text\">db.dropUser</code> 해당 데이터베이스의 유저객체를 삭제한다.</p>\n<ul>\n<li>삭제 예시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  use testDB\n  db<span class=\"token punctuation\">.</span><span class=\"token function\">dropUser</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testUser\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4>사용자 관리자 계정 생성</h4>\n<p>사용자 관리자는 데이터베이스나 다른 관리 기능을 운영하는 권한 말고 사용자를 생성할 수 있는 권한만 갖고 있어야 한다.</p>\n<ul>\n<li>\n<p>사용자를 생성하는 권한을 가진 계정 예시</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">use admin\ndb<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> user<span class=\"token punctuation\">:</span> <span class=\"token string\">\"useradmin\"</span><span class=\"token punctuation\">,</span>\npwd<span class=\"token punctuation\">:</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span>\nroles<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"userAdminAnyDatabase\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n<h4>인증</h4>\n<p>—auth 파라미터를 사용해서 재시작해야한다.</p>\n<p><code class=\"language-text\">mongod -dbpath &lt;/data/db&gt; —auth</code></p>\n<p>이후부터는 접근하기 위해 사용자와 패스워드를 이용해야 한다. 아니면 접속 후 명령어를 통해 로그인해야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">use admin\ndb<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"useradmin\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4>권한 설정후 접속방법</h4>\n<p><code class=\"language-text\">mongo &lt;host:port&gt; -u &lt;user&gt; -p &lt;pwd&gt; --authenticationDatabase &lt;database&gt;</code></p>\n<h4>또다른 권한 방법</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//루트계정생성</span>\n<span class=\"token operator\">></span> use admin\n<span class=\"token operator\">></span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ROOT_ID\"</span><span class=\"token punctuation\">,</span> pwd<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ROOT_PASSWO\"</span><span class=\"token punctuation\">,</span> roles<span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//재시작</span>\n$ sudo service mongod restart\n$ mongo\n<span class=\"token operator\">></span> mongo <span class=\"token operator\">&lt;</span>host<span class=\"token punctuation\">:</span>port<span class=\"token operator\">></span> <span class=\"token operator\">-</span>u <span class=\"token string\">\"ROOT_ID\"</span> <span class=\"token operator\">-</span>p <span class=\"token string\">\"ROOT_PASSWO\"</span> <span class=\"token operator\">--</span>authenticationDatabase <span class=\"token string\">\"admin\"</span>\n\n<span class=\"token comment\">//데이터베이스계정생성</span>\n<span class=\"token operator\">></span> use <span class=\"token constant\">DATABASE</span>\n<span class=\"token operator\">></span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">:</span> <span class=\"token string\">\"DB_USER_ID\"</span><span class=\"token punctuation\">,</span> pwd<span class=\"token punctuation\">:</span> <span class=\"token string\">\"DB_USER_PASSWORD\"</span><span class=\"token punctuation\">,</span> roles<span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"dbOwner\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//재접속</span>\n<span class=\"token operator\">></span> mongo <span class=\"token operator\">&lt;</span>host<span class=\"token punctuation\">:</span>port<span class=\"token operator\">/</span><span class=\"token constant\">DATABASE</span><span class=\"token operator\">></span> <span class=\"token operator\">-</span>u <span class=\"token string\">\"DB_USER_ID\"</span> <span class=\"token operator\">-</span>p <span class=\"token string\">\"DB_USER_PASSWORD\"</span></code></pre></div>","fields":{"slug":"/posts/5/","tagSlugs":["/tag/database/","/tag/mongodb/","/tag/auth/"]},"frontmatter":{"date":"2019-03-29T20:09","description":"mongoDB에서 권한 설정하는 방법","tags":["database","mongodb","auth"],"title":"mongoDB 권한 설정하는 방법"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/5/"}}